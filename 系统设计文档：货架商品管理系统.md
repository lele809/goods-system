系统设计文档：货架商品管理系统
一、系统概述
本系统用于管理货架商品的入库、出库、库存跟踪、金额统计等功能，仅支持单一管理员操作，不对外开放。

二、技术栈
模块	技术选型
后端	Spring Boot 3.x
前端	Vue 3 + TypeScript + Pinia + Element Plus
构建工具	Gradle
数据库	MySQL 8.x
权限管理	单用户（内置管理员账号）
API 交互	RESTful + JSON
三、数据库设计
表1：商品表 product
字段名	类型	说明
id	BIGINT	主键
name	VARCHAR(100)	商品名称
spec	VARCHAR(100)	规格
unit	VARCHAR(20)	单位
initial_stock	INT	初始库存数量
price	DECIMAL(10,2)	单价
created_at	DATETIME	创建时间
updated_at	DATETIME	更新时间
表2：出库记录表 outbound_record
字段名	类型	说明
id	BIGINT	主键
product_id	BIGINT	商品ID
out_date	DATE	出库日期
quantity	INT	出库数量
created_at	DATETIME	创建时间
四、后端设计（Spring Boot）
1. 项目结构
text
src/main/java/com/shelf/
├── entity/          # 实体类
├── repository/      # JPA Repository
├── service/         # 业务层
├── controller/      # 控制层
├── dto/            # 数据传输对象
└── ShelfApplication.java
2. 主要接口
功能	接口路径	方法	说明
获取所有商品	/api/products	GET	带分页和搜索
添加/更新商品	/api/product	POST	根据ID判断
删除商品	/api/product/{id}	DELETE	
出库操作	/api/outbound	POST	记录出库
获取出库记录	/api/outbounds	GET	按日期范围查询
按日期导出库存	/api/stock/export	GET	导出指定日期的库存信息
获取历史库存	/api/stock/history	GET	查询指定日期的库存状态
3. 关键实体类示例
java
@Entity
@Table(name = "product")
public class Product {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    private String name;
    private String spec;
    private String unit;
    private Integer initialStock;
    private BigDecimal price;
    // getters and setters
}

4. 库存计算逻辑
库存计算原理：
- 某日期的库存 = 初始库存 - 截止到该日期（包含当日）的累计出库数量
- 例如：商品A初始库存100个，25号累计出库91个，则25号库存为9个
- 26号又出库3个，则26号库存为6个，但25号库存仍为9个

5. 库存导出DTO示例
java
public class StockExportDTO {
    private Long productId;
    private String productName;
    private String spec;
    private String unit;
    private Integer stockQuantity;  // 指定日期的库存数量
    private BigDecimal unitPrice;
    private BigDecimal totalValue;  // 库存总价值
    private String stockDate;      // 库存统计日期
    // getters and setters
}
五、前端设计（Vue 3 + Element Plus）
1. 项目结构
text
src/
├── views/
│   ├── ProductList.vue    # 商品列表
│   ├── OutboundRecord.vue # 出库记录
│   └── Dashboard.vue      # 仪表盘
├── stores/
│   └── productStore.ts    # Pinia 状态管理
├── api/
│   └── productApi.ts      # 接口调用
└── main.ts
2. 页面功能
商品管理：展示商品列表，支持增删改查、导出Excel

出库记录：按日期记录出库，支持按商品筛选

库存管理：支持按日期查询历史库存状态，导出指定日期的库存Excel报表

仪表盘：展示库存概览、近期出库趋势

六、Gradle 配置示例（后端）
gradle
plugins {
    id 'org.springframework.boot' version '3.2.0'
    id 'io.spring.dependency-management' version '1.1.4'
    id 'java'
}

dependencies {
    implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
    implementation 'org.springframework.boot:spring-boot-starter-web'
    runtimeOnly 'com.mysql:mysql-connector-j'
    testImplementation 'org.springframework.boot:spring-boot-starter-test'
}
七、部署与运行
后端：
bash
./gradlew bootRun
前端：
bash
npm install
npm run dev
八、扩展建议（可选）
支持导入Excel初始化数据

支持库存预警通知（邮件/站内信）

支持商品图片上传

支持多仓库管理（如需扩展）

九、库存导出功能详细设计

1. 功能说明
支持按指定日期导出所有商品的库存状态，导出的库存数量为截止到指定日期的实际库存。

2. 计算示例
假设红枣商品：
- 初始库存：100包
- 24号出库：91包，24号库存 = 100 - 91 = 9包
- 25号无出库，25号库存 = 9包
- 26号出库：3包，26号库存 = 9 - 3 = 6包

导出25号库存：显示9包
导出26号库存：显示6包

3. 导出格式
Excel格式包含以下字段：
- 商品名称
- 规格
- 单位
- 库存数量
- 单价
- 库存总价值
- 统计日期

4. 技术实现要点
- 后端通过SQL查询计算历史库存
- 前端提供日期选择器和导出按钮
- 支持Excel文件下载